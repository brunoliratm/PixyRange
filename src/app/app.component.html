<div class="app-layout">
  <main class="main-content">
    <section class="mac-dashboard">
      <div class="input-panel">
        <header>
          <h2>PIXY RANGE</h2>
          <div class="header-meta">
            <p class="subtitle">Enter parameters to compute distance.</p>
            <a
              class="repo-link"
              href="https://github.com/brunoliratm/PixyRange"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                class="github-icon"
                viewBox="0 0 24 24"
                aria-hidden="true"
                focusable="false"
              >
                <path
                  fill="currentColor"
                  d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.44 9.8 8.2 11.39.6.11.82-.26.82-.58 0-.29-.01-1.23-.02-2.23-3.34.73-4.04-1.41-4.04-1.41-.55-1.4-1.33-1.77-1.33-1.77-1.09-.74.08-.73.08-.73 1.2.08 1.84 1.24 1.84 1.24 1.07 1.83 2.8 1.3 3.48.99.11-.77.42-1.3.76-1.6-2.67-.3-5.47-1.34-5.47-5.94 0-1.31.47-2.38 1.24-3.22-.12-.31-.54-1.53.12-3.19 0 0 1.01-.32 3.3 1.23a11.41 11.41 0 0 1 6 0c2.29-1.55 3.3-1.23 3.3-1.23.66 1.66.24 2.88.12 3.19.77.84 1.24 1.91 1.24 3.22 0 4.61-2.8 5.64-5.48 5.94.43.37.81 1.1.81 2.22 0 1.6-.01 2.89-.01 3.28 0 .32.21.69.82.58A12 12 0 0 0 24 12c0-6.63-5.37-12-12-12z"
                ></path>
              </svg>
              <span>GitHub</span>
            </a>
          </div>
        </header>

        <div class="form-group">
          <app-exif-reader
            (focalLengthChange)="onFocalLengthChange($event)"
          ></app-exif-reader>
        </div>

        <div class="form-group">
          <label>Real Object Size <span class="unit">(cm)</span></label>
          <input
            class="clean-input"
            type="number"
            [ngModel]="realSize()"
            (ngModelChange)="realSize.set($event)"
            placeholder="e.g., 170"
          />
        </div>

        <div class="form-group">
          <label>Object Width on Sensor <span class="unit">(px)</span></label>
          <input
            class="clean-input"
            type="number"
            [ngModel]="objectSizeInImage()"
            (ngModelChange)="objectSizeInImage.set($event)"
            placeholder="e.g., 400"
          />
        </div>

        <div class="form-group">
          <label>Focal Length <span class="unit">(mm)</span></label>
          <input
            class="clean-input"
            type="number"
            [ngModel]="focalLength()"
            (ngModelChange)="focalLength.set($event)"
            placeholder="e.g., 50"
          />
        </div>
      </div>

      <div class="result-panel" [class.active]="distancia() !== null">
        <div class="formula-card">
          <span class="formula-label">Formula Logic</span>
          <div class="math-equation">
            <span class="var">D</span> =
            <span class="fraction">
              <span class="numerator">
                <span class="token r">{{ realSize() || "R" }}</span> Ã—
                <span class="token f">{{ focalLength() || "F" }}</span>
              </span>
              <span class="denominator">
                <span class="token i">{{ objectSizeInImage() || "I" }}</span>
              </span>
            </span>
          </div>
        </div>

        <div class="image-selection-container">
          <h4 class="image-selection-description">
            Select the width of the object in the image.
          </h4>
          <canvas
            id="myCanvas"
            #myCanvas
            (mousedown)="onCanvasMouseDown($event)"
            (mouseup)="onCanvasMouseUp($event)"
            (touchstart)="onCanvasTouchStart($event)"
            (touchend)="onCanvasTouchEnd($event)"
          ></canvas>
        </div>

        <div class="final-result">
          <span class="label">Calculated Distance</span>
          <h1 class="value">
            @if (distancia(); as dist) {
              {{ dist | number: "1.2-2" }} <span class="unit">m</span>
            } @else {
              ---
            }
          </h1>
        </div>
      </div>
    </section>
  </main>
</div>
